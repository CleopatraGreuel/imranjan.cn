import{p as M,u as V,a as G,g as R,b as W,m as J,_ as B}from"./DvdQIjAm.js";import{A as D,B as T,x as l,r as A,C as U,e as K,c as g,o as c,q as P,F as Q,k as X,D as Y,s as I,_ as F,z as $,E as x,a,l as q,u as Z,f as ee,b as n}from"./CqSJX0oL.js";const te=["type","sizes","srcset"],se=["src","sizes","srcset"],L=D({__name:"NuxtPicture",props:M,emits:["load","error"],setup(s,{emit:t}){const e=s,d=T(),u=t,p=!1,h=V(),{attrs:w,options:j,modifiers:N}=G(e),z=l(()=>R(e.src)),k=l(()=>["png","webp","gif","svg"].includes(z.value)),f=l(()=>e.legacyFormat?e.legacyFormat:k.value?"png":"jpeg"),b=l(()=>{var m,y;const o=((m=e.format)==null?void 0:m.split(","))||(z.value==="svg"?["svg"]:(y=h.options.format)!=null&&y.length?[...h.options.format]:["webp"]);return o[0]==="svg"?[{src:e.src}]:(o.includes(f.value)&&o.splice(o.indexOf(f.value),1),o.push(f.value),o.map(E=>{const{srcset:O,sizes:C,src:H}=h.getSizes(e.src,{...j.value,sizes:e.sizes||h.options.screens,densities:e.densities,modifiers:{...N.value,format:E}});return{src:H,type:`image/${E}`,sizes:C,srcset:O}}))}),v=l(()=>b.value[b.value.length-1]),r=l(()=>{const o={...e.imgAttrs,"data-nuxt-pic":""};for(const m in d)m in W&&!(m in o)&&(o[m]=d[m]);return o}),i=A(),_=U().isHydrating;return K(()=>{i.value&&(i.value.complete&&_&&(i.value.getAttribute("data-error")?u("error",new Event("error")):u("load",new Event("load"))),i.value.onload=o=>{u("load",o)},i.value.onerror=o=>{u("error",o)},J("nuxt-picture"))}),(o,m)=>(c(),g("picture",null,[(c(!0),g(Q,null,X(b.value.slice(0,-1),y=>(c(),g("source",{key:y.src,type:y.type,sizes:y.sizes,srcset:y.srcset},null,8,te))),128)),v.value?(c(),g("img",Y({key:0,ref_key:"imgEl",ref:i},{...I(w),...I(p)?{onerror:"this.setAttribute('data-error', 1)"}:{},...r.value},{src:v.value.src,sizes:v.value.sizes,srcset:v.value.srcset}),null,16,se)):P("",!0)]))}}),ae={__name:"OptimizedImage",props:{src:{type:String,required:!0},alt:{type:String,default:""},width:{type:[Number,String],default:null},height:{type:[Number,String],default:null},loading:{type:String,default:"lazy",validator:s=>["lazy","eager"].includes(s)},quality:{type:Number,default:85,validator:s=>s>=1&&s<=100},format:{type:[String,Array],default:"webp",validator:s=>{const t=["webp","jpg","jpeg","png","avif","gif"];return Array.isArray(s)?s.every(e=>t.includes(e)):t.includes(s)}},fit:{type:String,default:"cover",validator:s=>["cover","contain","fill","inside","outside"].includes(s)},placeholder:{type:Boolean,default:!0},preset:{type:String,default:"",validator:s=>["","hero","project","photo","thumbnail"].includes(s)},sizes:{type:String,default:""},usePicture:{type:Boolean,default:!1},blur:{type:[Boolean,Number],default:!1},class:{type:[String,Array,Object],default:""}},setup(s){const t=s,e=A(!1),d=A(!1),u=A(null),p=l(()=>{const r={};return t.width&&(r.width=typeof t.width=="number"?`${t.width}px`:t.width),t.height&&(r.height=typeof t.height=="number"?`${t.height}px`:t.height),r}),h=l(()=>{const r={width:"100%",height:"100%"};return t.width&&t.height&&(r.aspectRatio=`${t.width} / ${t.height}`),r}),w=l(()=>{const r=["optimized-image","transition-opacity","duration-300"];return e.value?r.push("opacity-100"):r.push("opacity-0"),t.class&&(typeof t.class=="string"?r.push(t.class):Array.isArray(t.class)?r.push(...t.class):Object.keys(t.class).forEach(i=>{t.class[i]&&r.push(i)})),r.join(" ")}),j=l(()=>{const r={objectFit:t.fit,width:"100%",height:"100%"};return!e.value&&t.placeholder&&(r.position="absolute",r.top="0",r.left="0"),r}),N=l(()=>Array.isArray(t.format)?t.format[0]:t.format),z=l(()=>Array.isArray(t.format)?t.format:["webp",t.format].filter((r,i,S)=>S.indexOf(r)===i)),k=l(()=>{if(t.sizes)return t.sizes;switch(t.preset){case"hero":return"100vw";case"project":return"(max-width: 768px) 100vw, (max-width: 1024px) 50vw, 33vw";case"photo":return"(max-width: 768px) 100vw, (max-width: 1024px) 50vw, 33vw";case"thumbnail":return"(max-width: 768px) 50vw, 25vw";default:return t.width?`${t.width}px`:"100vw"}}),f=l(()=>{if(!t.blur)return;const r=typeof t.blur=="number"?t.blur:10;return`${t.src}?blur=${r}&quality=20&width=100`}),b=()=>{e.value=!0,d.value=!1},v=()=>{e.value=!1,d.value=!0};return(r,i)=>{const S=L,_=B;return c(),g("div",{class:"optimized-image-container",style:x(p.value)},[!e.value&&s.placeholder?(c(),g("div",{key:0,class:"image-placeholder animate-pulse bg-gray-200",style:x(h.value)},i[0]||(i[0]=[a("div",{class:"flex items-center justify-center h-full"},[a("svg",{class:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})])],-1)]),4)):P("",!0),s.usePicture?(c(),$(S,{key:1,ref_key:"imageRef",ref:u,src:s.src,alt:s.alt,width:s.width,height:s.height,quality:s.quality,format:z.value,loading:s.loading,sizes:k.value,preset:s.preset,class:q(w.value),style:x(j.value),placeholder:f.value,onLoad:b,onError:v},null,8,["src","alt","width","height","quality","format","loading","sizes","preset","class","style","placeholder"])):(c(),$(_,{key:2,ref_key:"imageRef",ref:u,src:s.src,alt:s.alt,width:s.width,height:s.height,quality:s.quality,format:N.value,loading:s.loading,sizes:k.value,preset:s.preset,class:q(w.value),style:x(j.value),placeholder:f.value,onLoad:b,onError:v},null,8,["src","alt","width","height","quality","format","loading","sizes","preset","class","style","placeholder"])),d.value?(c(),g("div",{key:3,class:"image-error bg-gray-100 border-2 border-dashed border-gray-300 flex items-center justify-center",style:x(h.value)},i[1]||(i[1]=[a("div",{class:"text-center text-gray-500"},[a("svg",{class:"w-8 h-8 mx-auto mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"})]),a("p",{class:"text-sm"},"图片加载失败")],-1)]),4)):P("",!0)],4)}}},re=F(ae,[["__scopeId","data-v-48bfcf99"]]),ie={class:"container mx-auto px-4 py-8"},oe={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"},le={class:"space-y-4"},de={class:"space-y-4"},ne={class:"space-y-4"},ce={class:"space-y-4"},ue={class:"space-y-4"},pe={class:"space-y-4"},me={class:"mt-12"},ge={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},he={class:"space-y-2"},fe={class:"space-y-2"},ve={class:"space-y-2"},ye={class:"mt-12"},be={__name:"test-images",setup(s){return Z({title:"@nuxt/image 功能测试",meta:[{name:"description",content:"测试@nuxt/image和Sharp图片处理功能"}]}),(t,e)=>{const d=B,u=L,p=re;return c(),g("div",ie,[e[11]||(e[11]=a("h1",{class:"text-3xl font-bold mb-8 text-center"},"@nuxt/image 功能测试",-1)),a("div",oe,[a("div",le,[e[0]||(e[0]=a("h2",{class:"text-xl font-semibold"},"基础NuxtImg",-1)),n(d,{src:"/images/hero/hero-bg.jpg",alt:"Hero背景测试",width:"400",height:"300",format:"webp",quality:"85",class:"rounded-lg shadow-md"})]),a("div",de,[e[1]||(e[1]=a("h2",{class:"text-xl font-semibold"},"NuxtPicture优化",-1)),n(u,{src:"/images/projects/project-1.jpg",alt:"项目图片测试",width:"400",height:"300",format:"webp",quality:"90",class:"rounded-lg shadow-md"})]),a("div",ne,[e[2]||(e[2]=a("h2",{class:"text-xl font-semibold"},"OptimizedImage组件",-1)),n(p,{src:"/images/photography/photo-1.jpg",alt:"摄影作品测试",preset:"photo",width:"400",height:"300",blur:!0,class:"rounded-lg shadow-md"})]),a("div",ce,[e[3]||(e[3]=a("h2",{class:"text-xl font-semibold"},"Hero预设",-1)),n(p,{src:"/images/hero/hero-project.jpg",alt:"Hero项目测试",preset:"hero",width:"400",height:"225",class:"rounded-lg shadow-md"})]),a("div",ue,[e[4]||(e[4]=a("h2",{class:"text-xl font-semibold"},"项目预设",-1)),n(p,{src:"/images/projects/project-2.jpg",alt:"项目预设测试",preset:"project",width:"400",height:"300",class:"rounded-lg shadow-md"})]),a("div",pe,[e[5]||(e[5]=a("h2",{class:"text-xl font-semibold"},"缩略图预设",-1)),n(p,{src:"/images/photography/photo-2.jpg",alt:"缩略图测试",preset:"thumbnail",width:"200",height:"150",class:"rounded-lg shadow-md"})])]),a("div",me,[e[9]||(e[9]=a("h2",{class:"text-2xl font-semibold mb-6"},"Sharp图片处理测试",-1)),a("div",ge,[a("div",he,[e[6]||(e[6]=a("h3",{class:"font-medium"},"WebP格式",-1)),n(d,{src:"/images/about/profile.jpg",alt:"WebP测试",format:"webp",width:"300",height:"300",class:"rounded-lg"})]),a("div",fe,[e[7]||(e[7]=a("h3",{class:"font-medium"},"JPEG格式",-1)),n(d,{src:"/images/about/profile.jpg",alt:"JPEG测试",format:"jpg",width:"300",height:"300",class:"rounded-lg"})]),a("div",ve,[e[8]||(e[8]=a("h3",{class:"font-medium"},"PNG格式",-1)),n(d,{src:"/images/about/profile.jpg",alt:"PNG测试",format:"png",width:"300",height:"300",class:"rounded-lg"})])])]),a("div",ye,[e[10]||(e[10]=a("h2",{class:"text-2xl font-semibold mb-6"},"响应式图片测试",-1)),n(p,{src:"/images/hero/landscape.jpg",alt:"响应式图片测试","use-picture":!0,sizes:"(max-width: 768px) 100vw, (max-width: 1024px) 50vw, 33vw",class:"w-full max-w-4xl mx-auto rounded-lg shadow-lg"})]),e[12]||(e[12]=ee('<div class="mt-12 p-6 bg-gray-50 rounded-lg" data-v-4db14e6d><h2 class="text-xl font-semibold mb-4" data-v-4db14e6d>功能状态检查</h2><div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm" data-v-4db14e6d><div class="space-y-2" data-v-4db14e6d><div class="flex justify-between" data-v-4db14e6d><span data-v-4db14e6d>@nuxt/image:</span><span class="text-green-600 font-medium" data-v-4db14e6d>✅ 已安装</span></div><div class="flex justify-between" data-v-4db14e6d><span data-v-4db14e6d>Sharp:</span><span class="text-green-600 font-medium" data-v-4db14e6d>✅ 已安装</span></div><div class="flex justify-between" data-v-4db14e6d><span data-v-4db14e6d>WebP支持:</span><span class="text-green-600 font-medium" data-v-4db14e6d>✅ 支持</span></div></div><div class="space-y-2" data-v-4db14e6d><div class="flex justify-between" data-v-4db14e6d><span data-v-4db14e6d>图片优化:</span><span class="text-green-600 font-medium" data-v-4db14e6d>✅ 启用</span></div><div class="flex justify-between" data-v-4db14e6d><span data-v-4db14e6d>响应式图片:</span><span class="text-green-600 font-medium" data-v-4db14e6d>✅ 启用</span></div><div class="flex justify-between" data-v-4db14e6d><span data-v-4db14e6d>预设配置:</span><span class="text-green-600 font-medium" data-v-4db14e6d>✅ 配置完成</span></div></div></div></div>',1))])}}},je=F(be,[["__scopeId","data-v-4db14e6d"]]);export{je as default};
